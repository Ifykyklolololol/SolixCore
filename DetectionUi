print("ver 1.7")
-- Detection UI Library
-- A smooth, modern UI library for displaying detection prompts

local DetectionUI = {}
DetectionUI.__index = DetectionUI

local TweenService = game:GetService("TweenService")

-- UI Configuration (matching keysystem style)
local CONFIG = {
	BackgroundColor = Color3.fromRGB(20, 20, 20),
	BorderColor = Color3.fromRGB(60, 60, 60),
	TextColor = Color3.fromRGB(255, 255, 255),
	TextColorSecondary = Color3.fromRGB(205, 205, 205),
	AccentColor = Color3.fromRGB(128, 213, 247), -- Keysystem accent color
	CloseButtonColor = Color3.fromRGB(255, 55, 55), -- Red for X button
	ButtonColor = Color3.fromRGB(38, 38, 38),
	TopBarColor = Color3.fromRGB(24, 24, 24),
	TransitionTime = 0.25,
	EasingStyle = Enum.EasingStyle.Quart,
	EasingDirection = Enum.EasingDirection.Out
}

function DetectionUI.new()
	local self = setmetatable({}, DetectionUI)
	
	self.gui = nil
	self.mainFrame = nil
	self.result = nil
	self.isVisible = false
	
	return self
end

function DetectionUI:CreateUI()
	-- Create ScreenGui
	self.gui = Instance.new("ScreenGui")
	self.gui.Name = "DetectionUI"
	self.gui.ResetOnSpawn = false
	self.gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
	self.gui.Parent = game:GetService("CoreGui")
	
	-- Get screen size for responsive design
	local screenSize = self.gui.AbsoluteSize
	local frameWidth = math.min(420, math.max(340, screenSize.X * 0.82))
	
	-- Create main container frame (keysystem style) - polished
	self.mainFrame = Instance.new("Frame")
	self.mainFrame.Name = "MainFrame"
	self.mainFrame.Size = UDim2.new(0, frameWidth, 0, 0) -- Height auto
	self.mainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
	self.mainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
	self.mainFrame.BackgroundColor3 = CONFIG.BackgroundColor
	self.mainFrame.BorderColor3 = CONFIG.BorderColor
	self.mainFrame.BorderSizePixel = 0
	self.mainFrame.ZIndex = 2
	self.mainFrame.AutomaticSize = Enum.AutomaticSize.Y
	self.mainFrame.Parent = self.gui
	
	-- Add size constraints for responsive design - polished
	local sizeConstraint = Instance.new("UISizeConstraint")
	sizeConstraint.MaxSize = Vector2.new(420, math.huge)
	sizeConstraint.MinSize = Vector2.new(340, 150)
	sizeConstraint.Parent = self.mainFrame
	
	-- Outline 1 (outer dark border)
	local outline1 = Instance.new("ImageLabel")
	outline1.Name = "OutlineMainFrame1"
	outline1.Parent = self.mainFrame
	outline1.BackgroundTransparency = 1
	outline1.Position = UDim2.new(0, 1, 0, 1)
	outline1.Size = UDim2.new(1, -2, 1, -2)
	outline1.Image = "rbxassetid://2592362371"
	outline1.ImageColor3 = CONFIG.BorderColor
	outline1.ScaleType = Enum.ScaleType.Slice
	outline1.SliceCenter = Rect.new(2, 2, 62, 62)
	
	-- Outline 2 (inner black border)
	local outline2 = Instance.new("ImageLabel")
	outline2.Name = "OutlineMainFrame2"
	outline2.Parent = self.mainFrame
	outline2.BackgroundTransparency = 1
	outline2.Size = UDim2.new(1, 0, 1, 0)
	outline2.Image = "rbxassetid://2592362371"
	outline2.ImageColor3 = Color3.fromRGB(0, 0, 0)
	outline2.ScaleType = Enum.ScaleType.Slice
	outline2.SliceCenter = Rect.new(2, 2, 62, 62)
	
	-- Top bar (keysystem style) - polished, taller to fit full title
	local topBar = Instance.new("Frame")
	topBar.Name = "TopBar"
	topBar.AnchorPoint = Vector2.new(0.5, 0)
	topBar.BackgroundColor3 = CONFIG.TopBarColor
	topBar.BorderSizePixel = 0
	topBar.Position = UDim2.new(0.5, 0, 0, 2)
	topBar.Size = UDim2.new(1, -5, 0, 0) -- Auto height
	topBar.AutomaticSize = Enum.AutomaticSize.Y
	topBar.Parent = self.mainFrame
	
	-- Title (keysystem style with Code font) - full text in top bar
	local title = Instance.new("TextLabel")
	title.Name = "TopBarTitle"
	title.Parent = topBar
	title.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	title.BackgroundTransparency = 1
	title.Position = UDim2.new(0, 10, 0, 6)
	title.Size = UDim2.new(1, -50, 0, 0)
	title.Font = Enum.Font.Code
	title.Text = "Game files changed! There is a risk of detection. Press proceed if you'd like to run the script anyway."
	title.TextColor3 = CONFIG.TextColor
	title.TextSize = 13
	title.TextXAlignment = Enum.TextXAlignment.Left
	title.TextYAlignment = Enum.TextYAlignment.Top
	title.TextWrapped = true
	title.AutomaticSize = Enum.AutomaticSize.Y
	title.LineHeight = 1.25
	
	-- Top bar line (accent color) - positioned after title
	local topBarLine = Instance.new("Frame")
	topBarLine.Name = "TopBarLine"
	topBarLine.Parent = topBar
	topBarLine.BackgroundColor3 = CONFIG.AccentColor
	topBarLine.BorderSizePixel = 0
	topBarLine.Position = UDim2.new(0, 0, 1, -1)
	topBarLine.Size = UDim2.new(1, 0, 0, 1)
	
	-- Animate accent color
	coroutine.wrap(function()
		while task.wait() do
			topBarLine.BackgroundColor3 = CONFIG.AccentColor
		end
	end)()
	
	-- Close button (X) - polished keysystem style, positioned at top right
	local closeButton = Instance.new("TextButton")
	closeButton.Name = "CloseButton"
	closeButton.Parent = topBar
	closeButton.BackgroundColor3 = CONFIG.CloseButtonColor
	closeButton.BorderSizePixel = 0
	closeButton.Position = UDim2.new(1, -30, 0, 4)
	closeButton.Size = UDim2.new(0, 26, 0, 24)
	closeButton.Font = Enum.Font.Code
	closeButton.Text = "Ã—"
	closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
	closeButton.TextSize = 18
	closeButton.AutoButtonColor = false
	closeButton.ZIndex = 10 -- Above title text
	
	-- Close button outline
	local closeOutline1 = Instance.new("ImageLabel")
	closeOutline1.Name = "CloseOutline1"
	closeOutline1.Parent = closeButton
	closeOutline1.BackgroundTransparency = 1
	closeOutline1.Size = UDim2.new(1, 0, 1, 0)
	closeOutline1.Image = "rbxassetid://2592362371"
	closeOutline1.ImageColor3 = CONFIG.BorderColor
	closeOutline1.ScaleType = Enum.ScaleType.Slice
	closeOutline1.SliceCenter = Rect.new(2, 2, 62, 62)
	
	local closeOutline2 = Instance.new("ImageLabel")
	closeOutline2.Name = "CloseOutline2"
	closeOutline2.Parent = closeButton
	closeOutline2.BackgroundTransparency = 1
	closeOutline2.Position = UDim2.new(0, 1, 0, 1)
	closeOutline2.Size = UDim2.new(1, -2, 1, -2)
	closeOutline2.Image = "rbxassetid://2592362371"
	closeOutline2.ImageColor3 = Color3.fromRGB(0, 0, 0)
	closeOutline2.ScaleType = Enum.ScaleType.Slice
	closeOutline2.SliceCenter = Rect.new(2, 2, 62, 62)
	
	-- Close button hover effect - polished with tween
	closeButton.MouseEnter:Connect(function()
		local tween = TweenService:Create(
			closeButton,
			TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
			{BackgroundTransparency = 0.15, Size = UDim2.new(0, 28, 0, 26)}
		)
		tween:Play()
	end)
	
	closeButton.MouseLeave:Connect(function()
		local tween = TweenService:Create(
			closeButton,
			TweenInfo.new(0.15, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
			{BackgroundTransparency = 0, Size = UDim2.new(0, 26, 0, 24)}
		)
		tween:Play()
	end)
	
	-- Close button click
	closeButton.MouseButton1Click:Connect(function()
		self.result = false
		self:Hide()
	end)
	
	-- Bottom bar with Run Anyway button - polished, bigger button
	local bottomBar = Instance.new("Frame")
	bottomBar.Name = "BottomBar"
	bottomBar.Size = UDim2.new(1, -20, 0, 50)
	bottomBar.Position = UDim2.new(0, 10, 1, -60)
	bottomBar.BackgroundTransparency = 1
	bottomBar.Parent = self.mainFrame
	
	-- Run Anyway button (polished keysystem style) - much bigger to fill space
	local runButton = Instance.new("TextButton")
	runButton.Name = "RunButton"
	runButton.Parent = bottomBar
	runButton.AnchorPoint = Vector2.new(0.5, 0)
	runButton.BackgroundColor3 = CONFIG.ButtonColor
	runButton.BorderColor3 = CONFIG.AccentColor
	runButton.BorderSizePixel = 0
	runButton.Position = UDim2.new(0.5, 0, 0, 5)
	runButton.Size = UDim2.new(1, 0, 0, 40) -- Full width, taller
	runButton.AutoButtonColor = false
	runButton.Font = Enum.Font.Code
	runButton.Text = "Run Anyway"
	runButton.TextColor3 = CONFIG.TextColor
	runButton.TextSize = 15
	
	-- Button outline 1
	local buttonOutline1 = Instance.new("ImageLabel")
	buttonOutline1.Name = "ButtonOutline1"
	buttonOutline1.Parent = runButton
	buttonOutline1.BackgroundTransparency = 1
	buttonOutline1.Size = UDim2.new(1, 0, 1, 0)
	buttonOutline1.Image = "rbxassetid://2592362371"
	buttonOutline1.ImageColor3 = CONFIG.BorderColor
	buttonOutline1.ScaleType = Enum.ScaleType.Slice
	buttonOutline1.SliceCenter = Rect.new(2, 2, 62, 62)
	
	-- Button outline 2
	local buttonOutline2 = Instance.new("ImageLabel")
	buttonOutline2.Name = "ButtonOutline2"
	buttonOutline2.Parent = runButton
	buttonOutline2.BackgroundTransparency = 1
	buttonOutline2.Position = UDim2.new(0, 1, 0, 1)
	buttonOutline2.Size = UDim2.new(1, -2, 1, -2)
	buttonOutline2.Image = "rbxassetid://2592362371"
	buttonOutline2.ImageColor3 = Color3.fromRGB(0, 0, 0)
	buttonOutline2.ScaleType = Enum.ScaleType.Slice
	buttonOutline2.SliceCenter = Rect.new(2, 2, 62, 62)
	
	-- Animate border color
	coroutine.wrap(function()
		while task.wait() do
			runButton.BorderColor3 = CONFIG.AccentColor
		end
	end)()
	
	-- Run button hover effect - polished with smooth tween
	runButton.MouseLeave:Connect(function()
		local tween = TweenService:Create(
			runButton,
			TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
			{BorderSizePixel = 0, Size = UDim2.new(1, 0, 0, 40), BackgroundTransparency = 0}
		)
		tween:Play()
	end)
	
	runButton.MouseEnter:Connect(function()
		local tween = TweenService:Create(
			runButton,
			TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
			{BorderSizePixel = 1, Size = UDim2.new(1, -4, 0, 42), BackgroundTransparency = 0.05}
		)
		tween:Play()
	end)
	
	-- Run button click
	runButton.MouseButton1Click:Connect(function()
		self.result = true
		self:Hide()
	end)
	
	-- Initially hide the UI
	self.mainFrame.Size = UDim2.new(0, 0, 0, 0)
	self.mainFrame.Visible = false
end


function DetectionUI:Show()
	if not self.gui then
		self:CreateUI()
	end
	
	self.isVisible = true
	self.result = nil
	
	-- Show the UI
	self.mainFrame.Visible = true
	
	-- Get screen size for responsive calculation
	local screenSize = self.gui.AbsoluteSize
	local frameWidth = math.min(420, math.max(340, screenSize.X * 0.82))
	
	-- Temporarily set size to calculate final dimensions
	self.mainFrame.Size = UDim2.new(0, frameWidth, 0, 0)
	self.mainFrame.AutomaticSize = Enum.AutomaticSize.Y
	
	-- Wait for layout to calculate properly
	task.wait(0.12)
	
	-- Get final sizes
	local finalMainSize = self.mainFrame.AbsoluteSize
	
	-- Reset to 0 for smooth animation
	self.mainFrame.Size = UDim2.new(0, 0, 0, 0)
	
	-- Animate main frame to final size with polished easing
	local showTween = TweenService:Create(
		self.mainFrame,
		TweenInfo.new(CONFIG.TransitionTime, Enum.EasingStyle.Quart, Enum.EasingDirection.Out),
		{Size = UDim2.new(0, finalMainSize.X, 0, finalMainSize.Y)}
	)
	showTween:Play()
	showTween.Completed:Wait()
	
	-- Re-enable automatic size for responsive behavior
	self.mainFrame.Size = UDim2.new(0, frameWidth, 0, 0)
	self.mainFrame.AutomaticSize = Enum.AutomaticSize.Y
end

function DetectionUI:Hide()
	if not self.isVisible then
		return
	end
	
	self.isVisible = false
	
	-- Animate out with polished easing
	local hideTween = TweenService:Create(
		self.mainFrame,
		TweenInfo.new(CONFIG.TransitionTime, Enum.EasingStyle.Quart, Enum.EasingDirection.In),
		{Size = UDim2.new(0, 0, 0, 0)}
	)
	
	hideTween:Play()
	hideTween.Completed:Wait()
	
	-- Clean up
	if self.gui then
		self.gui:Destroy()
		self.gui = nil
		self.mainFrame = nil
	end
end

function DetectionUI:Prompt()
	-- Create UI if it doesn't exist
	if not self.gui then
		self:CreateUI()
	end
	
	-- Show UI
	self:Show()
	
	-- Wait for user response
	while self.result == nil do
		task.wait(0.1)
	end
	
	local result = self.result
	return result
end

-- Create global API
local guiAPI = DetectionUI.new()

-- Example usage:
--[[
if scriptChanged then
	if not guiAPI:Prompt() then
		return -- don't load script
	end
end
]]

return guiAPI

